Протестировано на C++ Builder XE4